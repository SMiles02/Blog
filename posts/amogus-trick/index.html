<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Amogus Trick | Suneet's Blog</title>
<meta name=keywords content="tutorial,graphs"><meta name=description content="This post was originally written on Codeforces; relevant discussion can be found here.
I&rsquo;ve been meaning to write a blog about this interesting, but not (as far as I know) documented trick for a while. I&rsquo;ve decided to call it the Amogus trick after the first problem where I encountered and used it.
Prerequisites DSU Basic knowledge of 2-SAT (definitely not required, but it may make the blog easier to understand) Focus Problem: CF1594D - The Number of Imposters First, let&rsquo;s solve an easier version of this problem, where we just need to find whether there exists a configuration of player roles (i."><meta name=author content="Suneet Mahajan"><link rel=canonical href=https://suneetmahajan.com/Blog/posts/amogus-trick/><link crossorigin=anonymous href=/Blog/assets/css/stylesheet.26f4435ed15465338bc0ca32d69536b60ae28c54f408c4d3ae791082a8d052b0.css integrity="sha256-JvRDXtFUZTOLwMoy1pU2tgrijFT0CMTTrnkQgqjQUrA=" rel="preload stylesheet" as=style><link rel=icon href=https://suneetmahajan.com/Blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://suneetmahajan.com/Blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://suneetmahajan.com/Blog/favicon-32x32.png><link rel=apple-touch-icon href=https://suneetmahajan.com/Blog/apple-touch-icon.png><link rel=mask-icon href=https://suneetmahajan.com/Blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://suneetmahajan.com/Blog/posts/amogus-trick/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Amogus Trick"><meta property="og:description" content="This post was originally written on Codeforces; relevant discussion can be found here.
I&rsquo;ve been meaning to write a blog about this interesting, but not (as far as I know) documented trick for a while. I&rsquo;ve decided to call it the Amogus trick after the first problem where I encountered and used it.
Prerequisites DSU Basic knowledge of 2-SAT (definitely not required, but it may make the blog easier to understand) Focus Problem: CF1594D - The Number of Imposters First, let&rsquo;s solve an easier version of this problem, where we just need to find whether there exists a configuration of player roles (i."><meta property="og:type" content="article"><meta property="og:url" content="https://suneetmahajan.com/Blog/posts/amogus-trick/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-28T14:00:00+01:00"><meta property="article:modified_time" content="2022-08-28T14:00:00+01:00"><meta property="og:site_name" content="Suneet's blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Amogus Trick"><meta name=twitter:description content="This post was originally written on Codeforces; relevant discussion can be found here.
I&rsquo;ve been meaning to write a blog about this interesting, but not (as far as I know) documented trick for a while. I&rsquo;ve decided to call it the Amogus trick after the first problem where I encountered and used it.
Prerequisites DSU Basic knowledge of 2-SAT (definitely not required, but it may make the blog easier to understand) Focus Problem: CF1594D - The Number of Imposters First, let&rsquo;s solve an easier version of this problem, where we just need to find whether there exists a configuration of player roles (i."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://suneetmahajan.com/Blog/posts/"},{"@type":"ListItem","position":2,"name":"Amogus Trick","item":"https://suneetmahajan.com/Blog/posts/amogus-trick/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Amogus Trick","name":"Amogus Trick","description":"This post was originally written on Codeforces; relevant discussion can be found here.\nI\u0026rsquo;ve been meaning to write a blog about this interesting, but not (as far as I know) documented trick for a while. I\u0026rsquo;ve decided to call it the Amogus trick after the first problem where I encountered and used it.\nPrerequisites DSU Basic knowledge of 2-SAT (definitely not required, but it may make the blog easier to understand) Focus Problem: CF1594D - The Number of Imposters First, let\u0026rsquo;s solve an easier version of this problem, where we just need to find whether there exists a configuration of player roles (i.","keywords":["tutorial","graphs"],"articleBody":"This post was originally written on Codeforces; relevant discussion can be found here.\nI’ve been meaning to write a blog about this interesting, but not (as far as I know) documented trick for a while. I’ve decided to call it the Amogus trick after the first problem where I encountered and used it.\nPrerequisites DSU Basic knowledge of 2-SAT (definitely not required, but it may make the blog easier to understand) Focus Problem: CF1594D - The Number of Imposters First, let’s solve an easier version of this problem, where we just need to find whether there exists a configuration of player roles (i.e. Crewmate or Imposter) such that all the statements made by players so far are true.\nLet’s look at the two different types of statements made by players separately.\nCase 1: Player $i$ claims Player $j$ is a crewmate. Now, if Player $i$ is a crewmate, Player $j$ will also be a crewmate. Similarly, if Player $i$ is an imposter, Player $j$ will also be an imposter. The reversed versions of these statements are also true. Using this, we can create a virtual “edge” between Players $i$ and $j$, as their roles in the game will always be the same. More formally, for those familiar with 2-SAT or otherwise, we create the equivalency $v_i = v_j$.\nCase 2: Player $i$ claims Player $j$ is an imposter. Now, if Player $i$ is a crewmate, Player $j$ will be an imposter. Similarly, if Player $i$ is an imposter, Player $j$ will be a crewmate. We can create a virtual “anti-edge” between Players $i$ and $j$, as their roles in the game will always be the different. More formally, we create the equivalency $v_i = !v_j$.\nAdding edges is easy, we can just use normal DSU. But how do we deal with anti-edges? This is where the Amogus Trick comes in!\nWe can deal with these anti-edges by creating a DSU with $2n$ nodes, where nodes $1$ to $n$ represent player $i$ being a crewmate, and nodes $n + 1$ to $2n$ represent player $i - n$ being an imposter. Now, let’s look at those cases again.\nCase 1 results in both players having the same role in the game. Therefore, when such a statement is said, we can unite nodes $i$ and $j$, and similarly, unite nodes $i + n$ and $j + n$.\nCase 2 results in both players having differing roles in the game. Therefore, when such a statement is said, we can unite nodes $i$ and $j + n$, and similarly, unite nodes $i + n$ and $j$.\nTestcases 2 \u0026 3 of the sample input in the problem, respectively, visualised with the Amogus trick:\nSo, how can we solve our reduced problem with this? Note that a player can be exactly one of $\\{ \\text{Crewmate, Imposter} \\}$, so a configuration is invalid iff for some $1 \\le i \\le n$, nodes $i$ and $i + n$ are in the same component in our DSU. This is the only condition we need to check, as since the edges we add to our DSU are symmetric, there will always be a valid assignment of roles.\nIt’s not too difficult to extend this idea to solve our original problem.\nFull Solution Provided that there exists a solution for our configuration. We can give each node from $1$ to $n$ a weight of $0$, and each node from $n + 1$ to $2n$ a weight of $1$, as we only care about the number of imposters in our configuration. Now, for each pair of symmetric components, take the one that contains the maximum number of players being imposters.\nMy AC submission\nUsing this trick, we can solve a variety of other problems, such as dynamic bipartiteness checking, and it can often be paired with other modifications of DSU such as with support for rollbacks.\nOther Problems: Problems are ordered (roughly) in ascending order of difficulty.\nCF1702E - Split Into Two Sets\ntourist's AC Code 163478635\nCF1290C - Prefix Enlightenment\nMy AC Code 169912969\nCF1713E - Cross Swapping\nMy AC Code 169902868\nCF1444C - Team-Building\nMy AC Code 169902269\nA special thank you to kostia244, BucketPotato, fishy15 and AlperenT for providing feedback and/or sample problems!\n","wordCount":"704","inLanguage":"en","datePublished":"2022-08-28T14:00:00+01:00","dateModified":"2022-08-28T14:00:00+01:00","author":{"@type":"Person","name":"Suneet Mahajan"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://suneetmahajan.com/Blog/posts/amogus-trick/"},"publisher":{"@type":"Organization","name":"Suneet's Blog","logo":{"@type":"ImageObject","url":"https://suneetmahajan.com/Blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://suneetmahajan.com/Blog/ accesskey=h title="Suneet's blog (Alt + H)">Suneet's blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://suneetmahajan.com/Blog/ title=Home><span>Home</span></a></li><li><a href=https://suneetmahajan.com/Blog/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://suneetmahajan.com/Blog/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://suneetmahajan.com/Blog/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Amogus Trick</h1><div class=post-meta><span title='2022-08-28 14:00:00 +0100 BST'>August 28, 2022</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;704 words&nbsp;·&nbsp;Suneet Mahajan</div></header><div class=post-content><p><em>This post was originally written on Codeforces; relevant discussion can be found <a href=https://codeforces.com/blog/entry/106407>here</a>.</em></p><p>I&rsquo;ve been meaning to write a blog about this interesting, but not (as far as I know) documented trick for a while. I&rsquo;ve decided to call it the Amogus trick after the first problem where I encountered and used it.</p><h2 id=prerequisites>Prerequisites<a hidden class=anchor aria-hidden=true href=#prerequisites>#</a></h2><ul><li><a href=https://cp-algorithms.com/data_structures/disjoint_set_union.html>DSU</a></li><li>Basic knowledge of <a href=https://cp-algorithms.com/graph/2SAT.html>2-SAT</a> (definitely not required, but it may make the blog easier to understand)</li></ul><h2 id=focus-problem-cf1594d---the-number-of-impostershttpscodeforcescomcontest1594problemd>Focus Problem: <a href=https://codeforces.com/contest/1594/problem/D>CF1594D - The Number of Imposters</a><a hidden class=anchor aria-hidden=true href=#focus-problem-cf1594d---the-number-of-impostershttpscodeforcescomcontest1594problemd>#</a></h2><p>First, let&rsquo;s solve an easier version of this problem, where we just need to find whether there exists a configuration of player roles (i.e. Crewmate or Imposter) such that all the statements made by players so far are true.</p><p>Let&rsquo;s look at the two different types of statements made by players separately.</p><ul><li><p><strong>Case 1: Player $i$ claims Player $j$ is a crewmate.</strong> Now, if Player $i$ is a crewmate, Player $j$ will also be a crewmate. Similarly, if Player $i$ is an imposter, Player $j$ will also be an imposter. The reversed versions of these statements are also true. Using this, we can create a virtual &ldquo;edge&rdquo; between Players $i$ and $j$, as their roles in the game will always be the same. More formally, for those familiar with 2-SAT or otherwise, we create the equivalency $v_i = v_j$.</p></li><li><p><strong>Case 2: Player $i$ claims Player $j$ is an imposter.</strong> Now, if Player $i$ is a crewmate, Player $j$ will be an imposter. Similarly, if Player $i$ is an imposter, Player $j$ will be a crewmate. We can create a virtual &ldquo;anti-edge&rdquo; between Players $i$ and $j$, as their roles in the game will always be the different. More formally, we create the equivalency $v_i = !v_j$.</p></li></ul><p>Adding edges is easy, we can just use normal DSU. But how do we deal with anti-edges? This is where the Amogus Trick comes in!</p><p>We can deal with these anti-edges by creating a DSU with $2n$ nodes, where nodes $1$ to $n$ represent player $i$ being a crewmate, and nodes $n + 1$ to $2n$ represent player $i - n$ being an imposter. Now, let&rsquo;s look at those cases again.</p><ul><li><p><strong>Case 1</strong> results in both players having the same role in the game. Therefore, when such a statement is said, we can unite nodes $i$ and $j$, and similarly, unite nodes $i + n$ and $j + n$.</p></li><li><p><strong>Case 2</strong> results in both players having differing roles in the game. Therefore, when such a statement is said, we can unite nodes $i$ and $j + n$, and similarly, unite nodes $i + n$ and $j$.</p></li></ul><p>Testcases 2 & 3 of the sample input in the problem, respectively, visualised with the Amogus trick:</p><p><img loading=lazy src=https://i.imgur.com/7uAXXZX.png alt=" "></p><p><img loading=lazy src=https://i.imgur.com/ycehbCE.png alt=" "></p><p>So, how can we solve our reduced problem with this? Note that a player can be exactly one of $\{ \text{Crewmate, Imposter} \}$, so a configuration is invalid <em>iff</em> for some $1 \le i \le n$, nodes $i$ and $i + n$ are in the same component in our DSU. This is the only condition we need to check, as since the edges we add to our DSU are symmetric, there will always be a valid assignment of roles.</p><p>It&rsquo;s not too difficult to extend this idea to solve our original problem.</p><details><summary>Full Solution</summary><p>Provided that there exists a solution for our configuration. We can give each node from $1$ to $n$ a weight of $0$, and each node from $n + 1$ to $2n$ a weight of $1$, as we only care about the number of imposters in our configuration. Now, for each pair of symmetric components, take the one that contains the maximum number of players being imposters.</p><p><a href=https://codeforces.com/contest/1594/submission/169743782>My AC submission</a></p></details><p>Using this trick, we can solve a variety of other problems, such as dynamic bipartiteness checking, and it can often be paired with other modifications of DSU such as with support for rollbacks.</p><h2 id=other-problems>Other Problems:<a hidden class=anchor aria-hidden=true href=#other-problems>#</a></h2><p>Problems are ordered (roughly) in ascending order of difficulty.</p><p><a href=https://codeforces.com/contest/1702/problem/E>CF1702E - Split Into Two Sets</a></p><details><summary>tourist's AC Code</summary><p><a href=https://codeforces.com/contest/1702/submission/163478635>163478635</a></p></details><p><a href=https://codeforces.com/contest/1290/problem/C>CF1290C - Prefix Enlightenment</a></p><details><summary>My AC Code</summary><p><a href=https://codeforces.com/contest/1290/submission/169912969>169912969</a></p></details><p><a href=https://codeforces.com/contest/1713/problem/E>CF1713E - Cross Swapping</a></p><details><summary>My AC Code</summary><p><a href=https://codeforces.com/contest/1713/submission/169902868>169902868</a></p></details><p><a href=https://codeforces.com/contest/1444/problem/C>CF1444C - Team-Building</a></p><details><summary>My AC Code</summary><p><a href=https://codeforces.com/contest/1444/submission/169902269>169902269</a></p></details><p>A special thank you to <a href=https://codeforces.com/profile/kostia244>kostia244</a>, <a href=https://codeforces.com/profile/BucketPotato>BucketPotato</a>, <a href=https://codeforces.com/profile/fishy15>fishy15</a> and <a href=https://codeforces.com/profile/AlperenT>AlperenT</a> for providing feedback and/or sample problems!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://suneetmahajan.com/Blog/tags/tutorial/>Tutorial</a></li><li><a href=https://suneetmahajan.com/Blog/tags/graphs/>Graphs</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://suneetmahajan.com/Blog/>Suneet's Blog</a></span> ·</footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css integrity=sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js integrity=sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload=renderMathInElement(document.body)></script>>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>